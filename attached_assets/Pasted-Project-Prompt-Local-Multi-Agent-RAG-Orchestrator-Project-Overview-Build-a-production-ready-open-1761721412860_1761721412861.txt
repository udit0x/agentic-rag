Project Prompt: Local Multi-Agent RAG Orchestrator
Project Overview
Build a production-ready, open-source RAG (Retrieval-Augmented Generation) system with multi-agent orchestration, specialized reasoning modes, and temporal awareness. The system will run locally with Azure OpenAI integration.
Core Objectives

Multi-Agent Architecture: Implement Router, Retriever, Reasoning, Simulation, and Temporal agents with LangGraph orchestration
Specialized Reasoning Modes:

Standard factual retrieval
Counterfactual simulation ("what-if" scenarios)
Temporal truth detection (outdated knowledge identification)


Production-Ready UI: ChatGPT-style interface with context panels and optional reasoning trace visualization
Local-First Design: All data stored locally, Azure OpenAI for LLM/embeddings, optional local vector DB fallback

Technical Stack
Backend

Framework: FastAPI with async/await patterns
Orchestration: LangGraph for agent workflow, LangChain LCEL for chain composition
LLM: Azure OpenAI (GPT-4o/GPT-4-Turbo)
Embeddings: text-embedding-3-large via Azure OpenAI
Vector Store: Azure Cognitive Search (primary), Chroma (local fallback)
Storage: Local filesystem (/data directory)
Configuration: python-dotenv for environment management

Frontend

Framework: Next.js 14+ (App Router)
Styling: Tailwind CSS + ShadCN UI components
Animations: Framer Motion (subtle, purposeful)
State: React Query/SWR for server state
Markdown: react-markdown with syntax highlighting
Layout: Two-pane design (chat + context panel)

Key Dependencies

LangChain, LangGraph, LangChain Community
Azure OpenAI SDK
FastAPI, uvicorn
Pydantic for validation
React Query, Zustand (if needed for client state)

Agent Architecture
1. Router Agent
Purpose: Query classification and routing
Input: User query string
Output: Classification (factual/counterfactual/temporal) + confidence
Logic:

Pattern matching for keywords ("what if", "suppose", "imagine")
Timestamp analysis from metadata
LLM-based classification for ambiguous cases

2. Retriever Agent
Purpose: Document search and ranking
Input: Query + classification context
Output: Ranked chunks with metadata (source, timestamp, confidence)
Logic:

Semantic search via embeddings
Metadata filtering (date ranges, document types)
Re-ranking for relevance

3. Reasoning Agent
Purpose: Standard factual synthesis
Input: Query + retrieved chunks
Output: Natural language answer with citations
Logic:

Summarization with source attribution
Confidence scoring
Citation formatting

4. Simulation Agent
Purpose: Counterfactual reasoning with quantitative projections
Input: Query + baseline data + simulation parameters
Output: Projected scenario with comparison to current state
Logic:

Extract numerical parameters from query
Execute Python-based calculations (safe sandbox)
Generate comparative analysis

5. Temporal Agent
Purpose: Detect knowledge evolution and conflicts
Input: Retrieved chunks with timestamps
Output: Temporal analysis highlighting changes/conflicts
Logic:

Cluster documents by date
Identify contradictions across time periods
Flag outdated information
Generate timeline summary

Development Phases
Phase 1: Foundation (Start Here)
Goal: Basic RAG pipeline with document ingestion and retrieval
Backend Tasks:

Set up FastAPI project structure with proper routing
Implement Azure OpenAI client initialization with error handling
Create document ingestion endpoint (PDF/TXT support)
Build embedding generation pipeline with batching
Set up Azure Cognitive Search index with metadata schema
Implement basic retrieval endpoint with k results parameter

Frontend Tasks:

Initialize Next.js project with App Router
Set up Tailwind + ShadCN UI component library
Create chat interface layout (header, message list, input)
Build message components (user/assistant, loading states)
Implement API client service with error handling
Add document upload UI with progress indication

Deliverables:

Working document upload and embedding
Basic Q&A functionality with citations
Simple chat interface with message history